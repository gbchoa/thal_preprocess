%% Unzip zipped files
%==========================================================================
% Testpattern
%--------------------------------------------------------------------------
% You will need to edit the following to match your own folder structure

Fzipped     = '/Users/roschkoenig/Desktop/GitCode/Thalamic_Connectivity/Unzip Test';  
Funzipped   = '/Users/roschkoenig/Desktop/GitCode/Thalamic_Connectivity/Unzipped';
gz_files  	= cellstr(spm_select('FPList', Fzipped, 'gz$'));

for g = 1:length(gz_files)
    gfile           = gz_files{g};              % Select single file
    [path fname]    = spm_fileparts(gfile);     % Separate filename from path
    dotpos          = find(fname == '.');       % Find where extension begins
    foldname        = fname(1:dotpos-1);        % Folder name = filename without extension
    try mkdir([Funzipped fs foldname]); end     % Make folder if it doesn't already exist
    gunzip(gfile, foldname)
end




%%
f       = spm_select('FPList', dir_functional, ['^' subject]);
gunzip(f(k).name);

%% Unzip

clear all
zip_files = dir_base('*.gz');

for a = 1:n(zip_files)
    gunzip(zip_files(a)
    
end

n               = length(filenames);
filenames1      = struct('name', {zip_files(1:n).name});
name            = {filenames1.name}.';

for i=1:n
    foldername  = (name{i});
    foldername  = strrep(foldername,'.gz','');
    mkdir(foldername);
    unzip(name{i},foldername);
end
